(function() { const CONFIG = { blogUrl: 'https: maxPosts: 1000, autoplaySpeed: 5000 }; let state = { posts: [], currentIndex: 0, isPaused: false, timer: null }; const elements = { list: document.getElementById('jlpSliderList'), prev: document.getElementById('jlpPrevBtn'), next: document.getElementById('jlpNextBtn'), pause: document.getElementById('jlpPauseBtn') }; window.jlpHandleImgErr = function(img, index) { const postItem = document.getElementById('jlp-item-' + index); if (postItem) { postItem.remove(); if (postItem.classList.contains('active')) { showSlide(state.currentIndex); } } }; function init() { fetchPosts(); setupEventListeners(); } function fetchPosts() { const url = CONFIG.blogUrl + '/feeds/posts/default?alt=json&max-results=' + CONFIG.maxPosts; fetch(url) .then(res => res.json()) .then(data => { if (data.feed && data.feed.entry) { let posts = data.feed.entry.map(parseEntry); state.posts = posts.sort(() => Math.random() - 0.5); render(); startTimer(); } }) .catch(err => { console.error('Erro slider:', err); render(); }); } function parseEntry(entry) { let img = 'https: if (entry.media$thumbnail) img = entry.media$thumbnail.url.replace('/s72-c/', '/s600/'); let price = 'â‚¬0.00', oldPrice = ''; if (entry.category) { entry.category.forEach(c => { if (c.term.startsWith('Preco_')) price = 'â‚¬' + c.term.split('_')[1] + '.00'; if (c.term.includes('â‚¬')) price = c.term; }); } const link = entry.link.find(l => l.rel === 'alternate').href; const title = entry.title.$t; return { title, url: link, img, price, oldPrice }; } function render() { elements.list.innerHTML = state.posts.map((post, i) => { var html = '<li class="jlp-slider-item ' + (i === 0 ? 'active' : '') + '" id="jlp-item-' + i + '">'; html += '<a href="' + post.url + '" class="jlp-post-link">'; html += '<div class="jlp-post-thumbnail">'; html += '<img src="' + post.img + '" alt="' + post.title + '" onerror="jlpHandleImgErr(this, ' + i + ')">'; if (post.price) { html += '<div class="jlp-price-badge">'; if (post.oldPrice) html += '<span class="old-price">' + post.oldPrice + '</span>'; html += post.price + '</div>'; } html += '</div></a></li>'; return html; }).join(''); } function showSlide(index) { const items = elements.list.querySelectorAll('.jlp-slider-item'); if (!items.length) return; items.forEach(item => item.classList.remove('active')); state.currentIndex = index; if (state.currentIndex >= items.length) state.currentIndex = 0; if (state.currentIndex < 0) state.currentIndex = items.length - 1; if (items[state.currentIndex]) { items[state.currentIndex].classList.add('active'); } } function startTimer() { stopTimer(); if (!state.isPaused) { state.timer = setInterval(() => showSlide(state.currentIndex + 1), CONFIG.autoplaySpeed); } } function stopTimer() { if (state.timer) clearInterval(state.timer); } function togglePause() { state.isPaused = !state.isPaused; elements.pause.classList.toggle('paused', state.isPaused); if (state.isPaused) stopTimer(); else startTimer(); } function setupEventListeners() { elements.next.onclick = () => { showSlide(state.currentIndex + 1); startTimer(); }; elements.prev.onclick = () => { showSlide(state.currentIndex - 1); startTimer(); }; elements.pause.onclick = togglePause; let touchX = 0; elements.list.ontouchstart = e => touchX = e.touches[0].clientX; elements.list.ontouchend = e => { let diff = touchX - e.changedTouches[0].clientX; if (Math.abs(diff) > 50) { showSlide(state.currentIndex + (diff > 0 ? 1 : -1)); startTimer(); } }; } init(); })(); </script>]]></b:widget-setting> </b:widget-settings> <b:includable id='main'> <b:include name='widget-title'/> <div class='widget-content'> <data:content/> </div> </b:includable> </b:widget> </b:section> <!-- Coluna 3 - Links RÃ¡pidos --> <b:section class='footer-widget' id='footer-widget-3' maxwidgets='3' showaddelement='yes'> <b:widget id='HTML5' locked='false' title='PromoÃ§Ã£o' type='HTML' visible='true'> <b:widget-settings> <b:widget-setting name='content'><![CDATA[<!-- Bloco de Oferta Premium - JÃºlio LP --> <div style=" width: 100%; min-height: 365px; padding: 30px 20px; background: radial-gradient(circle at top right, #2c2c2c 0%, #1a1a1a 100%); border: 1px solid #d4af37; border-radius: 16px; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; font-family: 'Playfair Display', serif, 'Montserrat', sans-serif; color: #ffffff; box-shadow: 0 10px 30px rgba(0,0,0,0.5); position: relative; overflow: hidden; "> <!-- Detalhe decorativo (Vinil de fundo sutil) --> <div style="position: absolute; right: -30px; bottom: -30px; opacity: 0.1; pointer-events: none;"> <i class="fas fa-compact-disc" style="font-size: 150px; color: #d4af37;"></i> </div> <div style=" background: linear-gradient(135deg, #d4af37 0%, #f4d03f 100%); width: 60px; height: 60px; border-radius: 50%; display: flex; justify-content: center; align-items: center; margin-bottom: 15px; box-shadow: 0 4px 15px rgba(212, 175, 55, 0.4); "> <i class="fas fa-star" style="font-size: 26px; color: #1a1a1a;"></i> </div> <h3 style=" margin: 0; font-size: 24px; font-weight: 900; letter-spacing: 2px; text-transform: uppercase; color: #d4af37; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); "> ğ“ğ“¯ğ“®ğ“»ğ“½ğ“ª ğ“”ğ“¼ğ“¹ğ“®ğ“¬ğ“²ğ“ªğ“µ </h3> <p style=" font-size: 16px; margin: 10px 0 20px; font-weight: 400; color: #e0e0e0; letter-spacing: 0.5px; "> Aproveite <b>10% OFF</b> em todo o site <br /> <span style="font-size: 12px; opacity: 0.8;"> (Em compras acima de â‚¬50 â€¢ Exemplares Ãºnicos â€¢ op=op) </span> </p> <a href="/p/discos-de-vinil.html" style=" display: inline-block; background: #d4af37; color: #1a1a1a; padding: 12px 35px; border-radius: 4px; font-size: 13px; font-weight: 800; text-decoration: none; letter-spacing: 1.5px; text-transform: uppercase; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3); border: 1px solid transparent; " onmouseover="this.style.background='transparent'; this.style.color='#d4af37'; this.style.borderColor='#d4af37';" onmouseout="this.style.background='#d4af37'; this.style.color='#1a1a1a';"> Explorar ColeÃ§Ã£o </a> </div>]]></b:widget-setting> </b:widget-settings> <b:includable id='main'> <b:include name='widget-title'/> <div class='widget-content'> <data:content/> </div> </b:includable> </b:widget> </b:section> </div> </div> </footer> </b:if> <!-- Footer Bottom - VisÃ­vel em todas as pÃ¡ginas --> <div class='footer-bottom'> <p>&#169; <span id='footer-year'/> JÃºlio LP da Silva - Discos de Vinil. Todos os direitos reservados.</p> </div> <script> document.getElementById(&#39;footer-year&#39;).textContent = new Date().getFullYear(); </script> <!-- 1 JavaScript Principal --> <script> (function() { 'use strict'; const CONFIG = { whatsappNumber: "351919225483", checkoutPageUrl: "/p/checkout.html", cartStorageKey: "vinylCartComplete" }; window.cartData = { items: [], total: 0, count: 0 }; window.wishlist = []; function loadCart() { try { const saved = localStorage.getItem(CONFIG.cartStorageKey); if (saved) { window.cartData = JSON.parse(saved); } } catch (e) { } } function saveCart() { try { localStorage.setItem(CONFIG.cartStorageKey, JSON.stringify(window.cartData)); syncWithSimpleCart(); } catch (e) { } } function syncWithSimpleCart() { if (typeof simpleCart === 'undefined') return; simpleCart.empty(); window.cartData.items.forEach(item => { simpleCart.add({ name: item.title, price: item.price, quantity: item.quantity, thumb: item.image, url: item.url }); }); } function updateCartTotals() { window.cartData.count = 0; window.cartData.total = 0; window.cartData.items.forEach(item => { window.cartData.count += item.quantity; window.cartData.total += item.price * item.quantity; }); } function updateCartUI() { const countEl = document.getElementById('cartCount'); const itemsEl = document.getElementById('cartItems'); const footerEl = document.getElementById('cartFooter'); const subtotalEl = document.getElementById('cartSubtotal'); if (countEl) { countEl.textContent = window.cartData.count; countEl.style.display = window.cartData.count > 0 ? 'flex' : 'none'; } if (window.cartData.items.length === 0) { if (footerEl) footerEl.style.display = 'none'; if (itemsEl) itemsEl.innerHTML = '<div class="cart-empty"><i class="fas fa-shopping-cart"></i><p>Seu carrinho estÃ¡ vazio</p></div>'; return; } if (footerEl) footerEl.style.display = 'block'; let itemsHtml = ''; window.cartData.items.forEach(item => { itemsHtml += ` <div class="cart-item"> <div class="cart-item-image"><img src="${item.image}" alt="${item.title}" loading="lazy" onerror="this.src='https: <div class="cart-item-details"> <div class="cart-item-title">${item.title}</div> <div class="cart-item-artist">${item.artist}</div> <div class="cart-item-price">â‚¬${item.price.toFixed(2 )}</div> <div class="cart-item-quantity"> <button onclick="updateQuantity(${item.id}, -1)" class="qty-btn">âˆ’</button> <span>${item.quantity}</span> <button onclick="updateQuantity(${item.id}, 1)" class="qty-btn">+</button> </div> </div> <button class="cart-item-remove" onclick="removeFromCart(${item.id})"><i class="fas fa-trash"></i></button> </div>`; }); if (itemsEl) itemsEl.innerHTML = itemsHtml; if (subtotalEl) subtotalEl.textContent = 'â‚¬' + window.cartData.total.toFixed(2); } window.addToCart = function(button) { const card = button.closest('.product-card'); if (!card) return; const titleEl = card.querySelector('.product-title'); const priceEl = card.querySelector('.product-price'); if (!titleEl || !priceEl) return; const title = titleEl.textContent.trim(); const price = parseFloat(priceEl.getAttribute('data-price')) || 15.00; const existingItem = window.cartData.items.find(item => item.title === title); if (existingItem) { existingItem.quantity++; } else { window.cartData.items.push({ id: Date.now(), title: title, artist: card.querySelector('.product-artist')?.textContent.trim() || 'Artista', price: price, quantity: 1, image: card.querySelector('.product-thumb')?.src || '', url: button.getAttribute('data-url') || '#' }); } updateCartTotals(); saveCart(); updateCartUI(); }; window.addToCartSingle = function(button) { const container = button.closest('.product-single-container'); if (!container) return false; const titleEl = container.querySelector('.product-info-area h1'); const priceEl = container.querySelector('.product-price-value'); if (!titleEl || !priceEl) return false; const title = titleEl.textContent.trim().replace(/\s+/g, ' '); const price = parseFloat(priceEl.getAttribute('data-price')) || 15.00; const existingItem = window.cartData.items.find(item => item.title === title); if (existingItem) { } else { window.cartData.items.push({ id: Date.now(), title: title, artist: container.querySelector('.product-artist')?.textContent.trim() || 'Artista', price: price, quantity: 1, image: container.querySelector('.product-main-image img')?.src || '', url: window.location.href }); } updateCartTotals(); saveCart(); updateCartUI(); return true; }; window.removeFromCart = function(id) { window.cartData.items = window.cartData.items.filter(item => item.id !== id); updateCartTotals(); saveCart(); updateCartUI(); }; window.updateQuantity = function(id, change) { const item = window.cartData.items.find(item => item.id === id); if (!item) return; item.quantity += change; if (item.quantity <= 0) { window.removeFromCart(id); } else { updateCartTotals(); saveCart(); updateCartUI(); } }; window.toggleCart = function() { document.getElementById('cartSidebar')?.classList.toggle('active'); document.getElementById('cartOverlay')?.classList.toggle('active'); }; window.openCart = function() { const cartSidebar = document.getElementById('cartSidebar'); const cartOverlay = document.getElementById('cartOverlay'); if (cartSidebar && cartOverlay) { cartSidebar.classList.add('active'); cartOverlay.classList.add('active'); document.body.style.overflow = 'hidden'; console.log('âœ… Carrinho aberto automaticamente'); } }; window.closeCart = function() { const cartSidebar = document.getElementById('cartSidebar'); const cartOverlay = document.getElementById('cartOverlay'); if (cartSidebar && cartOverlay) { cartSidebar.classList.remove('active'); cartOverlay.classList.remove('active'); document.body.style.overflow = ''; } }; window.goToCheckout = function() { if (window.cartData.items.length === 0) return alert('Seu carrinho estÃ¡ vazio!'); saveCart(); window.location.href = CONFIG.checkoutPageUrl; }; window.buyNowAndCheckout = function() { const success = window.addToCartSingle(document.getElementById('addToCartBtn')); if (success) { window.goToCheckout(); } else { alert('Ocorreu um erro ao adicionar o produto. Tente novamente.'); } }; window.checkoutWhatsApp = function() { if (window.cartData.items.length === 0) return alert('Seu carrinho estÃ¡ vazio!'); let msg = 'ğŸµ OlÃ¡! Gostaria de encomendar os seguintes discos:\n\n'; window.cartData.items.forEach(item => { msg += `*${item.title}*\n`; msg += `Quantidade: ${item.quantity}\n`; msg += `PreÃ§o: â‚¬${(item.price * item.quantity).toFixed(2)}\n\n`; }); msg += `*Total do Pedido: â‚¬${window.cartData.total.toFixed(2)}*`; const whatsappUrl = `https: window.open(whatsappUrl, '_blank'); }; window.buyWhatsAppSingleProduct = function() { const container = document.querySelector('.product-single-container'); if (!container) return; const titleEl = container.querySelector('.product-info-area h1'); const priceEl = container.querySelector('.product-price-value'); if (!titleEl || !priceEl) return; const title = titleEl.textContent.trim().replace(/\s+/g, ' '); const price = priceEl.getAttribute('data-price') || 'N/A'; const productUrl = window.location.href; let msg = `ğŸµ OlÃ¡! Tenho interesse em comprar este disco:\n\n*${title}*\nPreÃ§o: â‚¬${price}\n\nLink do produto: ${productUrl}`; const whatsappUrl = `https: window.open(whatsappUrl, '_blank'); }; function loadWishlist() { try { const saved = localStorage.getItem('vinylWishlist'); if (saved) { window.wishlist = JSON.parse(saved); } } catch (e) { console.error('Erro ao carregar favoritos:', e); window.wishlist = []; } } function saveWishlist() { try { localStorage.setItem('vinylWishlist', JSON.stringify(window.wishlist)); } catch (e) { console.error('Erro ao salvar favoritos:', e); } } function formatPrice(price) { const numPrice = parseFloat(price); return isNaN(numPrice) ? '0.00' : numPrice.toFixed(2); } function updateWishlistCount() { const countEl = document.getElementById('wishlistCount'); if (countEl) { countEl.textContent = window.wishlist.length; countEl.style.display = window.wishlist.length > 0 ? 'flex' : 'none'; } } window.updateWishlistUI = function() { const itemsDiv = document.getElementById('wishlistItems'); const footer = document.getElementById('wishlistFooter'); if (!itemsDiv) return; updateWishlistCount(); if (window.wishlist.length === 0) { if (footer) footer.style.display = 'none'; itemsDiv.innerHTML = ` <div class="cart-empty"> <i class="fas fa-heart" style="color:#e74c3c;"></i> <p>Nenhum favorito ainda</p> </div> `; return; } if (footer) footer.style.display = 'block'; let html = ''; window.wishlist.forEach(function(item, index) { const title = item.title || 'Produto sem nome'; const artist = item.artist || 'Artista'; const price = formatPrice(item.price); const image = item.image || 'https: const url = item.url || '#'; html += ` <div class="cart-item" style="position:relative;"> <div class="cart-item-image"> <img src="${image}" alt="${title}" loading="lazy" onerror="this.src='https: </div> <div class="cart-item-details" style="flex:1;"> <div class="cart-item-title"> <a href="${url}" style="color:#1a1a1a;">${title}</a> </div> <div class="cart-item-artist">${artist}</div> <div class="cart-item-price">â‚¬${price}</div> </div> <button class="cart-item-remove" onclick="removeFromWishlist(${index})" style="background:#e74c3c;" title="Remover dos favoritos"> <i class="fas fa-trash"></i> </button> </div> `; }); itemsDiv.innerHTML = html; }; window.addToWishlist = function(button) { const card = button.closest('.product-card'); if (!card) return; const titleEl = card.querySelector('.product-title a') || card.querySelector('.product-title'); const priceEl = card.querySelector('.product-price'); if (!titleEl || !priceEl) return; const fullTitle = titleEl.textContent.trim(); const price = parseFloat(priceEl.getAttribute('data-price')) || 0; const image = card.querySelector('.product-thumb')?.src || ''; const url = titleEl.href || window.location.href; const id = fullTitle.replace(/\s+/g, '-').toLowerCase(); const index = window.wishlist.findIndex(item => item.id === id); if (index > -1) { window.wishlist.splice(index, 1); button.classList.remove('active'); button.innerHTML = '<i class="far fa-heart"></i>'; } else { let title = fullTitle; let artist = 'Artista'; if (fullTitle.includes(' - ')) { const parts = fullTitle.split(' - '); artist = parts[0].trim(); title = parts.slice(1).join(' - ').trim(); } window.wishlist.push({ id: id, title: title, artist: artist, price: price, image: image, url: url }); button.classList.add('active'); button.innerHTML = '<i class="fas fa-heart"></i>'; } saveWishlist(); window.updateWishlistUI(); const sidebar = document.getElementById('wishlistSidebar'); const overlay = document.getElementById('wishlistOverlay'); if (sidebar && overlay) { sidebar.classList.add('active'); overlay.classList.add('active'); document.body.style.overflow = 'hidden'; } }; window.addToWishlistSingle = function(button) { const container = button.closest('.product-single-container') || document.querySelector('.product-single-container'); if (!container) return; const titleEl = container.querySelector('.product-info-area h1, h1'); const priceEl = container.querySelector('.product-price-value'); const imageEl = container.querySelector('.product-main-image img'); if (!titleEl || !priceEl) return; const fullTitle = titleEl.textContent.trim().replace(/\s+/g, ' '); const price = parseFloat(priceEl.getAttribute('data-price')) || 0; const image = imageEl ? imageEl.src : ''; const url = window.location.href; const id = fullTitle.replace(/\s+/g, '-').toLowerCase(); const index = window.wishlist.findIndex(item => item.id === id); if (index > -1) { window.wishlist.splice(index, 1); button.classList.remove('active'); button.innerHTML = '<i class="far fa-heart"></i>'; } else { let title = fullTitle; let artist = 'Artista'; if (fullTitle.includes(' - ')) { const parts = fullTitle.split(' - '); artist = parts[0].trim(); title = parts.slice(1).join(' - ').trim(); } window.wishlist.push({ id: id, title: title, artist: artist, price: price, image: image, url: url }); button.classList.add('active'); button.innerHTML = '<i class="fas fa-heart"></i>'; } saveWishlist(); window.updateWishlistUI(); const sidebar = document.getElementById('wishlistSidebar'); const overlay = document.getElementById('wishlistOverlay'); if (sidebar && overlay) { sidebar.classList.add('active'); overlay.classList.add('active'); document.body.style.overflow = 'hidden'; } }; window.removeFromWishlist = function(index) { if (index >= 0 && index < window.wishlist.length) { window.wishlist.splice(index, 1); saveWishlist(); updateWishlistCount(); window.updateWishlistUI(); } }; window.toggleWishlistSidebar = function() { const sidebar = document.getElementById('wishlistSidebar'); const overlay = document.getElementById('wishlistOverlay'); if (sidebar && overlay) { sidebar.classList.toggle('active'); overlay.classList.toggle('active'); document.body.style.overflow = sidebar.classList.contains('active') ? 'hidden' : ''; window.updateWishlistUI(); } }; window.closeWishlist = function() { const sidebar = document.getElementById('wishlistSidebar'); const overlay = document.getElementById('wishlistOverlay'); if (sidebar && overlay) { sidebar.classList.remove('active'); overlay.classList.remove('active'); document.body.style.overflow = ''; } }; window.viewAllWishlist = function() { if (typeof toggleWishlistSidebar === 'function') { toggleWishlistSidebar(); } window.location.href = '/p/favoritos.html'; }; function init() { loadCart(); loadWishlist(); updateCartUI(); window.updateWishlistUI(); syncWithSimpleCart(); const cartOverlay = document.getElementById('cartOverlay'); const wishlistOverlay = document.getElementById('wishlistOverlay'); if (cartOverlay) { cartOverlay.addEventListener('click', closeCart); } if (wishlistOverlay) { wishlistOverlay.addEventListener('click', closeWishlist); } document.addEventListener('keydown', function(e) { if (e.key === 'Escape') { closeCart(); closeWishlist(); } }); updateWishlistButtons(); console.log('âœ… Sistema inicializado - Carrinho e Favoritos com auto-abertura'); } function updateWishlistButtons() { document.querySelectorAll('.btn-wishlist, .product-wishlist-btn').forEach(btn => { const card = btn.closest('.product-card'); const titleEl = card ? card.querySelector('.product-title a') : document.querySelector('.product-info-area h1, h1'); if (titleEl) { const id = titleEl.textContent.trim().replace(/\s+/g, '-').toLowerCase(); const exists = window.wishlist.some(item => item.id === id); if (exists) { btn.classList.add('active'); btn.innerHTML = '<i class="fas fa-heart"></i>'; } else { btn.classList.remove('active'); btn.innerHTML = '<i class="far fa-heart"></i>'; } } }); } if (document.readyState === 'loading') { document.addEventListener('DOMContentLoaded', init); } else { init(); } })();
