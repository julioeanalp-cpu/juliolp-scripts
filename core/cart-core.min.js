!function(){"use strict";const e={whatsappNumber:"351919225483",checkoutPageUrl:"/p/checkout.html",cartStorageKey:"vinylCartComplete"};function t(){try{const t=localStorage.getItem(e.cartStorageKey);t&&(window.cartData=JSON.parse(t))}catch(e){}}function a(){try{localStorage.setItem(e.cartStorageKey,JSON.stringify(window.cartData)),n()}catch(e){}}function n(){if(void 0!==simpleCart){simpleCart.empty(),window.cartData.items.forEach((e=>{simpleCart.add({name:e.title,price:e.price,quantity:e.quantity,thumb:e.image,url:e.url})}))}}function i(){window.cartData.count=0,window.cartData.total=0,window.cartData.items.forEach((e=>{window.cartData.count+=e.quantity,window.cartData.total+=e.price*e.quantity}))}function o(){const e=document.getElementById("cartCount"),t=document.getElementById("cartItems"),a=document.getElementById("cartFooter"),n=document.getElementById("cartSubtotal");if(e&&(e.textContent=window.cartData.count,e.style.display=window.cartData.count>0?"flex":"none"),0===window.cartData.items.length)return a&&(a.style.display="none"),void(t&&(t.innerHTML='<div class="cart-empty"><i class="fas fa-shopping-cart"></i><p>Seu carrinho est√° vazio</p></div>'));a&&(a.style.display="block");let i="";window.cartData.items.forEach((e=>{i+=`
                <div class="cart-item">
                    <div class="cart-item-image"><img src="${e.image}" alt="${e.title}" loading="lazy" onerror="this.src='https://via.placeholder.com/80x80/d4af37/1a1a1a?text=Vinil'"></div>
                    <div class="cart-item-details">
                        <div class="cart-item-title">${e.title}</div>
                        <div class="cart-item-artist">${e.artist}</div>
                        <div class="cart-item-price">‚Ç¨${e.price.toFixed(2 )}</div>
                        <div class="cart-item-quantity">
                            <button onclick="updateQuantity(${e.id}, -1)" class="qty-btn">‚àí</button>
                            <span>${e.quantity}</span>
                            <button onclick="updateQuantity(${e.id}, 1)" class="qty-btn">+</button>
                        </div>
                    </div>
                    <button class="cart-item-remove" onclick="removeFromCart(${e.id})"><i class="fas fa-trash"></i></button>
                </div>`})),t&&(t.innerHTML=i),n&&(n.textContent="‚Ç¨"+window.cartData.total.toFixed(2))}function s(){try{const e=localStorage.getItem("vinylWishlist");e&&(window.wishlist=JSON.parse(e))}catch(e){console.error("Erro ao carregar favoritos:",e),window.wishlist=[]}}function r(){try{localStorage.setItem("vinylWishlist",JSON.stringify(window.wishlist))}catch(e){console.error("Erro ao salvar favoritos:",e)}}function l(e){const t=parseFloat(e);return isNaN(t)?"0.00":t.toFixed(2)}function d(){const e=document.getElementById("wishlistCount");e&&(e.textContent=window.wishlist.length,e.style.display=window.wishlist.length>0?"flex":"none")}function c(){document.querySelectorAll(".btn-wishlist, .product-wishlist-btn").forEach((e=>{const t=e.closest(".product-card"),a=t?t.querySelector(".product-title a"):document.querySelector(".product-info-area h1, h1");if(a){const t=a.textContent.trim().replace(/\s+/g,"-").toLowerCase(),n=window.wishlist.some((e=>e.id===t));n?(e.classList.add("active"),e.innerHTML='<i class="fas fa-heart"></i>'):(e.classList.remove("active"),e.innerHTML='<i class="far fa-heart"></i>')}}))}window.cartData={items:[],total:0,count:0},window.wishlist=[],window.addToCart=function(e){const t=e.closest(".product-card");if(!t)return;const n=t.querySelector(".product-title"),s=t.querySelector(".product-price");if(!n||!s)return;const r=n.textContent.trim(),l=parseFloat(s.getAttribute("data-price"))||15,d=window.cartData.items.find((e=>e.title===r));d?d.quantity++:window.cartData.items.push({id:Date.now(),title:r,artist:t.querySelector(".product-artist")?.textContent.trim()||"Artista",price:l,quantity:1,image:t.querySelector(".product-thumb")?.src||"",url:e.getAttribute("data-url")||"#"}),i(),a(),o()},window.addToCartSingle=function(e){const t=e.closest(".product-single-container");if(!t)return!1;const n=t.querySelector(".product-info-area h1"),s=t.querySelector(".product-price-value");if(!n||!s)return!1;const r=n.textContent.trim().replace(/\s+/g," "),l=parseFloat(s.getAttribute("data-price"))||15,d=window.cartData.items.find((e=>e.title===r));return d||window.cartData.items.push({id:Date.now(),title:r,artist:t.querySelector(".product-artist")?.textContent.trim()||"Artista",price:l,quantity:1,image:t.querySelector(".product-main-image img")?.src||"",url:window.location.href}),i(),a(),o(),!0},window.removeFromCart=function(e){window.cartData.items=window.cartData.items.filter((t=>t.id!==e)),i(),a(),o()},window.updateQuantity=function(e,t){const n=window.cartData.items.find((t=>t.id===e));n&&(n.quantity+=t,n.quantity<=0?window.removeFromCart(e):(i(),a(),o()))},window.toggleCart=function(){document.getElementById("cartSidebar")?.classList.toggle("active"),document.getElementById("cartOverlay")?.classList.toggle("active")},window.openCart=function(){const e=document.getElementById("cartSidebar"),t=document.getElementById("cartOverlay");e&&t&&(e.classList.add("active"),t.classList.add("active"),document.body.style.overflow="hidden")},window.closeCart=function(){const e=document.getElementById("cartSidebar"),t=document.getElementById("cartOverlay");e&&t&&(e.classList.remove("active"),t.classList.remove("active"),document.body.style.overflow="")},window.goToCheckout=function(){0===window.cartData.items.length?alert("Seu carrinho est√° vazio!"):(a(),window.location.href=e.checkoutPageUrl)},window.buyNowAndCheckout=function(){window.addToCartSingle(document.getElementById("addToCartBtn"))?window.goToCheckout():alert("Ocorreu um erro ao adicionar o produto. Tente novamente.")},window.checkoutWhatsApp=function(){if(0===window.cartData.items.length)return alert("Seu carrinho est√° vazio!");let t="üéµ Ol√°! Gostaria de encomendar os seguintes discos:\n\n";window.cartData.items.forEach((e=>{t+=`*${e.title}*\n`,t+=`Quantidade: ${e.quantity}\n`,t+=`Pre√ßo: ‚Ç¨${(e.price*e.quantity).toFixed(2)}\n\n`})),t+=`*Total do Pedido: ‚Ç¨${window.cartData.total.toFixed(2)}*`;const a=`https://wa.me/${e.whatsappNumber}?text=${encodeURIComponent(t )}`;window.open(a,"_blank")},window.buyWhatsAppSingleProduct=function(){const t=document.querySelector(".product-single-container");if(!t)return;const a=t.querySelector(".product-info-area h1"),n=t.querySelector(".product-price-value");if(!a||!n)return;const i=a.textContent.trim().replace(/\s+/g," "),o=n.getAttribute("data-price")||"N/A",s=window.location.href;let r=`üéµ Ol√°! Tenho interesse em comprar este disco:\n\n*${i}*\nPre√ßo: ‚Ç¨${o}\n\nLink do produto: ${s}`;const l=`https://wa.me/${e.whatsappNumber}?text=${encodeURIComponent(r )}`;window.open(l,"_blank")},window.updateWishlistUI=function(){const e=document.getElementById("wishlistItems"),t=document.getElementById("wishlistFooter");if(!e)return;if(d(),0===window.wishlist.length)return t&&(t.style.display="none"),void(e.innerHTML='<div class="cart-empty"><i class="fas fa-heart" style="color:#e74c3c;"></i><p>Nenhum favorito ainda</p></div>');t&&(t.style.display="block");let a="";window.wishlist.forEach((function(e,t){const n=e.title||"Produto sem nome",i=e.artist||"Artista",o=l(e.price),s=e.image||"https://via.placeholder.com/80x80/e74c3c/ffffff?text=‚ô•",r=e.url||"#";a+=`<div class="cart-item" style="position:relative;"><div class="cart-item-image"><img src="${s}" alt="${n}" loading="lazy" onerror="this.src='https://via.placeholder.com/80x80/e74c3c/ffffff?text=‚ô•'"></div><div class="cart-item-details" style="flex:1;"><div class="cart-item-title"><a href="${r}" style="color:#1a1a1a;">${n}</a></div><div class="cart-item-artist">${i}</div><div class="cart-item-price">‚Ç¨${o}</div></div><button class="cart-item-remove" onclick="removeFromWishlist(${t} )" style="background:#e74c3c;" title="Remover dos favoritos"><i class="fas fa-trash"></i></button></div>`})),e.innerHTML=a},window.addToWishlist=function(e){const t=e.closest(".product-card");if(!t)return;const a=t.querySelector(".product-title a")||t.querySelector(".product-title"),n=t.querySelector(".product-price");if(!a||!n)return;const i=a.textContent.trim(),o=parseFloat(n.getAttribute("data-price"))||0,s=t.querySelector(".product-thumb")?.src||"",l=a.href||window.location.href,d=i.replace(/\s+/g,"-").toLowerCase(),c=window.wishlist.findIndex((e=>e.id===d));if(c>-1)window.wishlist.splice(c,1),e.classList.remove("active"),e.innerHTML='<i class="far fa-heart"></i>';else{let t=i,a="Artista";i.includes(" - ")&&(parts=i.split(" - "),a=parts[0].trim(),t=parts.slice(1).join(" - ").trim()),window.wishlist.push({id:d,title:t,artist:a,price:o,image:s,url:l}),e.classList.add("active"),e.innerHTML='<i class="fas fa-heart"></i>'}r(),window.updateWishlistUI();const u=document.getElementById("wishlistSidebar"),m=document.getElementById("wishlistOverlay");u&&m&&(u.classList.add("active"),m.classList.add("active"),document.body.style.overflow="hidden")},window.addToWishlistSingle=function(e){const t=e.closest(".product-single-container")||document.querySelector(".product-single-container");if(!t)return;const a=t.querySelector(".product-info-area h1, h1"),n=t.querySelector(".product-price-value"),i=t.querySelector(".product-main-image img");if(!a||!n)return;const o=a.textContent.trim().replace(/\s+/g," "),s=parseFloat(n.getAttribute("data-price"))||0,l=i?i.src:"",d=window.location.href,c=o.replace(/\s+/g,"-").toLowerCase(),u=window.wishlist.findIndex((e=>e.id===c));if(u>-1)window.wishlist.splice(u,1),e.classList.remove("active"),e.innerHTML='<i class="far fa-heart"></i>';else{let t=o,a="Artista";o.includes(" - ")&&(parts=o.split(" - "),a=parts[0].trim(),t=parts.slice(1).join(" - ").trim()),window.wishlist.push({id:c,title:t,artist:a,price:s,image:l,url:d}),e.classList.add("active"),e.innerHTML='<i class="fas fa-heart"></i>'}r(),window.updateWishlistUI();const m=document.getElementById("wishlistSidebar"),w=document.getElementById("wishlistOverlay");m&&w&&(m.classList.add("active"),w.classList.add("active"),document.body.style.overflow="hidden")},window.removeFromWishlist=function(e){e>=0&&e<window.wishlist.length&&(window.wishlist.splice(e,1),r(),d(),window.updateWishlistUI())},window.toggleWishlistSidebar=function(){const e=document.getElementById("wishlistSidebar"),t=document.getElementById("wishlistOverlay");e&&t&&(e.classList.toggle("active"),t.classList.toggle("active"),document.body.style.overflow=e.classList.contains("active")?"hidden":"",window.updateWishlistUI())},window.closeWishlist=function(){const e=document.getElementById("wishlistSidebar"),t=document.getElementById("wishlistOverlay");e&&t&&(e.classList.remove("active"),t.classList.remove("active"),document.body.style.overflow="")},window.viewAllWishlist=function(){"function"==typeof toggleWishlistSidebar&&toggleWishlistSidebar(),window.location.href="/p/favoritos.html"},function(){t(),s(),o(),window.updateWishlistUI(),n();const e=document.getElementById("cartOverlay"),a=document.getElementById("wishlistOverlay");e&&e.addEventListener("click",window.closeCart),a&&a.addEventListener("click",window.closeWishlist),document.addEventListener("keydown",(function(e){"Escape"===e.key&&(window.closeCart(),window.closeWishlist())})),c(),console.log("‚úÖ Sistema inicializado")}(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(function(){t(),s(),o(),window.updateWishlistUI(),n()})):void 0}();
